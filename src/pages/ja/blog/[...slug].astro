---
import JaBaseLayout from "../../../layouts/JaBaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("blog", ({ data }) => data.locale === "ja" && !data.draft);

  return entries.map((entry) => {
    const slugWithoutLocale = entry.slug.replace(/^ja\//, "");
    return {
      params: { slug: slugWithoutLocale },
      props: { entry },
    };
  });
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<JaBaseLayout>
  <h1>{entry.data.title}</h1>

  <p>
    <small>
      {entry.data.pubDate.toISOString().slice(0, 10)}
      {entry.data.updatedDate ? `（更新 ${entry.data.updatedDate.toISOString().slice(0, 10)}）` : ""}
    </small>
  </p>

  <Content />
</JaBaseLayout>
